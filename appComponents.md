# アプリコンポーネント

## 概要

・コンポーネントは、**システムやユーザーがアプリを起動するためのエントリーポイント**

・一部のコンポーネントは、他のコンポーネントに依存する

## 種類

### アクティビティ(Activities)

### サービス(Services)

### ブロードキャストレシーバー(Broadcast receivers)

### コンテンツプロバイダー(Content Providers)

## アクティビティ

・ユーザーとやり取りするためのエントリーポイント

・***UIを含む1つの画面を表す***

 ### ex) メールアプリ

・新しいメールのリストを示すアクティビティ

・メールを作成するアクティビティ

・メールを読むためのアクティビティ

→これらのアクティビティが連携して一貫した動作をするが、各アクティビティはあくまで独立している

・メールアプリ側で許可されていれば、他のアプリからこれらのアクティビティのいずれかを開始できる

ex)カメラアプリで写真を撮る→メール作成アクティビティを開始する

### 役割

・ユーザーが現在関心を持っていること（画面上に何があるのか）を追跡し、アクティビティをホストしているプロセスを実行し続ける

・以前に使用したプロセスに、ユーザーが戻ってくる停止アクティビティが含まれているかどうかを把握し、それらのプロセスの優先順位を高くして可用性を維持

・アプリのプロセスの強制終了の処理をサポートし、ユーザーが以前の状態が復元されたアクティビティに戻れるようにする

・アプリ間でユーザーフローを実装し、システムがこれらのフローを調整できるようにする。

## サービス

・アプリをバックグラウンドで実行し続けるためのエントリポイント

・***UIを提供しない***

・柔軟性の高さから、さまざまなシステムコンセプトの重要な構成要素になる

### 二つのサービス

・`Started services`,`Bound services`の二つのサービスがある

### Started services

・処理が完了するまでサービスの実行を継続するようにシステムに指示する

ex)

・データをバックグラウンドで同期する

→ユーザーが直接処理を認識しないので、プロセスをより自由に管理できる。

　(より重要な処理のために、一度サービスを終了して、後で再開するなど)

・音楽を再生する

→ユーザーが直接認識しているため、フォアグラウンドでの動作を宣言する

 再生中であることを示す通知を表示し、停止しないようにシステムはサービスの実行を優先する

 ### Bound services

・他のアプリ(システム)がサービスを利用するように指示した場合に実行される

・このサービスは別のプロセスにAPIを敵強し、プロセス間に依存関係があることをシステムに認識させる

## ブロードキャストレシーバー

・アプリがシステム全体のブロードキャスト通知に対応できるように、通常のフロー外でシステムがイベントをアプリに配信できるようにする

・現在実行されていないアプリに対しても配信できる

ex)アラームを設定する　など

・画面オフ、バッテリー残量低下、画像キャプチャなどのブロードキャストがシステムから配信される

・UIは提供されないが、通知を作成することができる

・あくまで他のコンポーネントへのゲートであり、最小限の作業をすることを目的としている

・***各ブロードキャストは`Intent`として配信される***

## コンテンツプロバイダ

・ファイルシステム、SQLiteデータベース、ウェブ、その他の永続ストレージに保存されるデータの共有セットを管理する

・コンテンツプロバイダが許可する場合、他のアプリはコンテンツプロバイダを介してデータ取得や変更ができる

・URIスキームで識別される

・URIを所持するアプリ終了後も、URIを保持で着る

・URIごとに細かいセキュリティモデルを提供する


## Android コンポーネントの特徴

・どのアプリからでも別アプリのコンポーネントを起動できる

→写真を撮りたい時、別アプリのを呼び出して写真を元のアプリに送ってもらう、なども可能

・別のアプリのアクティビティを起動した場合、元のアプリのプロセスではなく、起動先のアプリのプロセスで実行される

→単一のエントリポイントはなく、`main()`関数は存在しない

